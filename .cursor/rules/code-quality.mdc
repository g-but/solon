---
description: "Solon code quality - Bitcoin governance patterns"
alwaysApply: true
---

# Code Quality Rules

## Architecture

Next.js 14 Bitcoin governance platform:
- `src/app/` - Pages and API routes
- `src/components/` - UI components
- `src/lib/` - Business logic, Bitcoin integration
- `prisma/` - Database schema

## Core Principles

### 1. DRY - Don't Repeat Yourself
- Centralize Bitcoin utilities in `lib/bitcoin/`
- Reuse voting logic in `lib/solon/`
- Use shared UI components

### 2. SSOT - Single Source of Truth
| Data | Location |
|------|----------|
| Navigation | `lib/site-config.ts` |
| Design Tokens | Tailwind config |
| Database | `prisma/schema.prisma` |
| Bitcoin Config | Environment variables |

### 3. Security First
- Cryptographic verification for all votes
- Never expose private keys
- Validate all API inputs

## Design System

Use consistent colors:
```typescript
// Tailwind classes
className="bg-navy text-solon-orange"
className="border-bitcoin-orange"

// NOT arbitrary values
className="bg-[#1e293b]"  // Wrong
```

## TypeScript Standards

```typescript
// Explicit types for Bitcoin amounts
interface Transaction {
  id: string;
  amount: number; // BTC (not satoshis in UI)
  timestamp: Date;
  signature: string;
}

// Voting with cryptographic proof
interface Vote {
  sessionId: string;
  choice: string;
  signature: string;
  publicKey: string;
}
```

## API Security

```typescript
// Always verify signatures
export async function POST(request: Request) {
  const { vote, signature } = await request.json();
  
  if (!verifySignature(vote, signature)) {
    return Response.json({ error: 'Invalid signature' }, { status: 400 });
  }
  // ...
}
```

## Don't

- Skip signature verification
- Hardcode wallet addresses
- Use colors outside design system
- Leave broken navigation links
